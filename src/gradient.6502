

\\ Calculate the gradient of a line delta dx,dy
\\
\\ Inputs:
\\   A      = dy (lsb)
\\   X      = dx
\\
\\ Result:
\\   A/X    = gradient (lsb/msb)

\\ todo: gradient sign, 16-bit dy, clamp abs(gradient) to &7FFF
.calc_gradient
{
	STA mullo_ptr:STA mulhi_ptr
	EOR #255:STA mulneglo_ptr:STA mulneghi_ptr
	
	LDY reciptabhi,X
	SEC
	LDA (mullo_ptr),Y:SBC (mulneglo_ptr),Y:STA dydxlo	; todo: just use some safe temp location
	LDA (mulhi_ptr),Y:SBC (mulneghi_ptr),Y
	
	LDY reciptablo,X
	TAX
	LDA (mulhi_ptr),Y:SBC (mulneghi_ptr),Y
	
	CLC:ADC dydxlo:BCC P%+3:INX
	RTS
}
